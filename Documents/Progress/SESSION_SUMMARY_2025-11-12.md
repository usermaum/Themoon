# ì„¸ì…˜ ìš”ì•½ - 2025ë…„ 11ì›” 12ì¼

## ğŸ“Œ ì„¸ì…˜ ì •ë³´
- **ë‚ ì§œ**: 2025-11-12
- **ì‹œì‘ ë²„ì „**: v0.30.3
- **ëª©í‘œ ë²„ì „**: v0.31.0 (MINOR - ê±°ë˜ ëª…ì„¸ì„œ ì´ë¯¸ì§€ ìë™ ì…ê³  ê¸°ëŠ¥)
- **ì‘ì—… ì‹œê°„**: ~ì§„í–‰ì¤‘
- **ì£¼ìš” ì‘ì—…**: í™˜ê²½ ì„¤ì • (Phase 0) â†’ Phase 1~6 êµ¬í˜„ ì˜ˆì •

---

## ğŸ¯ ì™„ë£Œëœ ì‘ì—…

### 1. í™˜ê²½ ë¬¸ì œ í•´ê²° - Unity Hub & Tesseract OCR âœ…

**ë¬¸ì œ ìƒí™©:**
- Unity Hub íŒ¨í‚¤ì§€ ë¬¸ì œë¡œ `tesseract-ocr-kor` ì„¤ì¹˜ ì°¨ë‹¨
- OCR í•œê¸€ ì§€ì› í•„ìš” (ê±°ë˜ ëª…ì„¸ì„œ ì´ë¯¸ì§€ ì²˜ë¦¬)

**í•´ê²° ê³¼ì •:**
1. Unity Hub ê°•ì œ ì œê±° (ì‚¬ìš©ì í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰)
   ```bash
   sudo dpkg --remove --force-all unityhub
   sudo apt-get install -f
   ```

2. Tesseract OCR í•œê¸€ ì–¸ì–´íŒ© ì„¤ì¹˜
   ```bash
   sudo apt-get install -y tesseract-ocr-kor
   ```

3. ì„¤ì¹˜ í™•ì¸
   ```bash
   tesseract --list-langs
   # ê²°ê³¼: eng, kor, osd
   ```

**ê²°ê³¼:**
- âœ… Tesseract OCRì—ì„œ í•œê¸€(kor) ì§€ì› í™•ì¸
- âœ… Unity Hub ë¬¸ì œ í•´ê²°
- âœ… ì´ë¯¸ì§€ OCR í™˜ê²½ êµ¬ì¶• ì™„ë£Œ

---

### 2. Phase 0: í™˜ê²½ ì„¤ì • (1ì‹œê°„) âœ…

**ëª©í‘œ**: OCR ë° ì´ë¯¸ì§€ ì²˜ë¦¬ í™˜ê²½ êµ¬ì¶•

**ì‘ì—… ë‚´ìš©:**

**Task 0-1: ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ í™•ì¸**
- âœ… tesseract-ocr: ì„¤ì¹˜ í™•ì¸
- âœ… tesseract-ocr-kor: ì„¤ì¹˜ í™•ì¸ (ìœ„ì—ì„œ í•´ê²°)
- âœ… poppler-utils: 24.02.0-1ubuntu9.8 (PDF ì²˜ë¦¬)

**Task 0-2: Python íŒ¨í‚¤ì§€ ì„¤ì¹˜**
```bash
./venv/bin/pip install \
  pytesseract==0.3.10 \
  opencv-python==4.8.1.78 \
  pdf2image==1.16.3 \
  python-Levenshtein==0.25.0 \
  dateparser==1.2.0
```

ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€:
- `pytesseract-0.3.10`: Tesseract OCR Python wrapper
- `opencv-python-4.8.1.78`: ì´ë¯¸ì§€ ì „ì²˜ë¦¬ (íšŒì „, ëŒ€ë¹„, ë…¸ì´ì¦ˆ ì œê±°)
- `pdf2image-1.16.3`: PDF â†’ ì´ë¯¸ì§€ ë³€í™˜
- `python-Levenshtein-0.25.0`: ì›ë‘ëª… ìœ ì‚¬ë„ ë§¤ì¹­ (Levenshtein Distance)
- `dateparser-1.2.0`: ë‹¤ì–‘í•œ ë‚ ì§œ í˜•ì‹ íŒŒì‹±

**Task 0-3: ë””ë ‰í† ë¦¬ ìƒì„±**
```bash
mkdir -p data/invoices/temp
```
- `data/invoices/`: ê±°ë˜ ëª…ì„¸ì„œ ì´ë¯¸ì§€ ì˜êµ¬ ë³´ê´€
- `data/invoices/temp/`: ì„ì‹œ ì´ë¯¸ì§€ íŒŒì¼

**Task 0-4: requirements.txt ì—…ë°ì´íŠ¸**
- `requirements.txt`ì— "Image Processing & OCR" ì„¹ì…˜ ì¶”ê°€
- 6ê°œ íŒ¨í‚¤ì§€ ëª…ì‹œ

**ì»¤ë°‹:**
```
8e92edb0 chore: OCR ë° ì´ë¯¸ì§€ ì²˜ë¦¬ íŒ¨í‚¤ì§€ ì¶”ê°€ (Phase 0)
```

**ê²€ì¦ ê¸°ì¤€:**
- âœ… `tesseract --version` ì„±ê³µ
- âœ… `import pytesseract` ì„±ê³µ
- âœ… `data/invoices/` ë””ë ‰í† ë¦¬ ì¡´ì¬

**ê²°ê³¼:**
- âœ… Phase 0 ì™„ë£Œ (ì˜ˆìƒ ì‹œê°„: 1ì‹œê°„, ì‹¤ì œ ì‹œê°„: ~30ë¶„)
- âœ… í™˜ê²½ êµ¬ì¶• ì™„ë£Œ, Phase 1 ì§„í–‰ ê°€ëŠ¥

---

### 3. Phase 1: ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ (2ì‹œê°„) âœ…

**ëª©í‘œ**: Invoice ê´€ë ¨ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ ë° ë§ˆì´ê·¸ë ˆì´ì…˜ êµ¬í˜„

**ì‘ì—… ë‚´ìš©:**

**Task 1-1: Invoice ëª¨ë¸ ìƒì„± (app/models/invoice.py)**
- `Invoice` í´ë˜ìŠ¤ (91 lines)
  - ê±°ë˜ ëª…ì„¸ì„œ ë©”íƒ€ë°ì´í„°
  - í•„ë“œ: image_path, supplier, invoice_date, total_amount, status, confidence_score, ocr_raw_text
  - ê´€ê³„: Invoice 1:N InvoiceItem

- `InvoiceItem` í´ë˜ìŠ¤
  - ëª…ì„¸ì„œ í•­ëª© (ë‹¤ì¤‘ ì›ë‘ ì§€ì›)
  - í•„ë“œ: invoice_id, bean_id, bean_name_raw, quantity, unit_price, amount, origin, notes, confidence_score
  - ê´€ê³„: InvoiceItem N:1 Bean, InvoiceItem 1:N InvoiceLearning

- `InvoiceLearning` í´ë˜ìŠ¤
  - í•™ìŠµ ë°ì´í„° (ì‚¬ìš©ì ìˆ˜ì • ë‚´ì—­ ì €ì¥)
  - í•„ë“œ: invoice_item_id, ocr_text, corrected_value, field_name
  - ëª©ì : í–¥í›„ ë™ì¼ ì˜¤ë¥˜ ë°œìƒ ì‹œ ìë™ ì œì•ˆ

**Task 1-2: ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ (migrations/add_invoice_tables.py)**
- 172 lines
- ê¸°ëŠ¥:
  1. DB ìë™ ë°±ì—… (timestamp í¬í•¨)
  2. 3ê°œ í…Œì´ë¸” ìƒì„± (invoices, invoice_items, invoice_learning)
  3. `transactions` í…Œì´ë¸”ì— `invoice_item_id` ì»¬ëŸ¼ ì¶”ê°€
  4. í…Œì´ë¸” ì¡´ì¬ ì—¬ë¶€ ê²€ì¦

- ì‹¤í–‰ ê²°ê³¼:
  ```
  âœ… invoices í…Œì´ë¸” ìƒì„± ì™„ë£Œ
  âœ… invoice_items í…Œì´ë¸” ìƒì„± ì™„ë£Œ
  âœ… invoice_learning í…Œì´ë¸” ìƒì„± ì™„ë£Œ
  âœ… transactions.invoice_item_id ì»¬ëŸ¼ ì¶”ê°€ ì™„ë£Œ
  ```

**Task 1-3: database.py ì—…ë°ì´íŠ¸**
- Invoice ëª¨ë¸ import ì¶”ê°€
- Circular import ë°©ì§€ë¥¼ ìœ„í•œ ìƒëŒ€ ê²½ë¡œ ì‚¬ìš© (`.invoice`)

**ì»¤ë°‹:**
```
408d26ea feat: Phase 1 ì™„ë£Œ - Invoice ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ êµ¬í˜„
```

**ê²€ì¦ ê¸°ì¤€:**
- âœ… ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì„±ê³µ
- âœ… 3ê°œ í…Œì´ë¸” ìƒì„± í™•ì¸
- âœ… SQLAlchemy ëª¨ë¸ë¡œ CRUD ì‘ë™ í™•ì¸ (ì˜ˆì •)

**ê²°ê³¼:**
- âœ… Phase 1 ì™„ë£Œ (ì˜ˆìƒ ì‹œê°„: 2ì‹œê°„, ì‹¤ì œ ì‹œê°„: ~1.5ì‹œê°„)
- âœ… ë²„ì „ ìë™ ì—…ë°ì´íŠ¸: v0.30.3 â†’ v0.31.0 (MINOR)
- âœ… ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ êµ¬ì¶• ì™„ë£Œ, Phase 2 ì§„í–‰ ê°€ëŠ¥

---

---

### 4. Phase 2: ì´ë¯¸ì§€ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹° (4ì‹œê°„) âœ…

**ëª©í‘œ**: ì´ë¯¸ì§€ ì „ì²˜ë¦¬ ë° í…ìŠ¤íŠ¸ íŒŒì‹± ìœ í‹¸ë¦¬í‹° êµ¬í˜„

**ì‘ì—… ë‚´ìš©:**

**Task 2-1: image_utils.py êµ¬í˜„ (268 lines, 8ê°œ í•¨ìˆ˜)**
- âœ… `preprocess_image()`: ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ (ê·¸ë ˆì´ìŠ¤ì¼€ì¼ + CLAHE + ë¸”ëŸ¬ + ì´ì§„í™”)
- âœ… `enhance_contrast()`: CLAHE ëŒ€ë¹„ í–¥ìƒ
- âœ… `denoise_image()`: Gaussian Blur ë…¸ì´ì¦ˆ ì œê±°
- âœ… `rotate_image()`: íšŒì „ ë³´ì •
- âœ… `pdf_to_image()`: PDF â†’ ì´ë¯¸ì§€ ë³€í™˜ (ì²« í˜ì´ì§€)
- âœ… `convert_uploaded_file_to_image()`: Streamlit íŒŒì¼ ì²˜ë¦¬
- âœ… `save_image()`: ì´ë¯¸ì§€ ì €ì¥
- âœ… `get_image_info()`: ë©”íƒ€ë°ì´í„° ì¶”ì¶œ

**Task 2-2: text_parser.py êµ¬í˜„ - ê¸°ë³¸ íŒŒì‹± (693 lines, 18ê°œ í•¨ìˆ˜)**

ê¸°ë³¸ íŒŒì‹± í•¨ìˆ˜ (13ê°œ):
- âœ… `normalize_text()`: í…ìŠ¤íŠ¸ ì •ê·œí™” (ê³µë°±, ì†Œë¬¸ì)
- âœ… `extract_bean_name()`: ì›ë‘ëª… ì¶”ì¶œ (ì˜ë¬¸/í•œê¸€ íŒ¨í„´)
- âœ… `extract_quantity()`: ìˆ˜ëŸ‰ ì¶”ì¶œ (kg/g â†’ kg ë³€í™˜)
- âœ… `extract_price()`: ê°€ê²© ì¶”ì¶œ (â‚©, ì›, ìˆ«ì)
- âœ… `extract_date()`: ë‚ ì§œ ì¶”ì¶œ (dateparser + ë°±ì—… íŒ¨í„´)
- âœ… `extract_supplier_name()`: ê³µê¸‰ì—…ì²´ëª… ì¶”ì¶œ
- âœ… `extract_total_amount()`: ì´ì•¡ ì¶”ì¶œ
- âœ… `extract_origin()`: ì›ì‚°ì§€ ì¶”ì¶œ (15ê°œ ì»¤í”¼ ìƒì‚°êµ­)
- âœ… `fuzzy_match_bean()`: ì›ë‘ëª… ìœ ì‚¬ë„ ë§¤ì¹­ (Levenshtein Distance)
- âœ… `parse_invoice_basic()`: ê¸°ë³¸ ëª…ì„¸ì„œ íŒŒì‹± (í†µí•©)
- âœ… `calculate_amount()`: ê³µê¸‰ê°€ì•¡ ê³„ì‚°
- âœ… `validate_parsed_data()`: ë°ì´í„° ê²€ì¦ (í•„ìˆ˜ í•„ë“œ í™•ì¸)

**Task 2-3: text_parser.py êµ¬í˜„ - GSC ì „ìš© íŒŒì‹± (5ê°œ í•¨ìˆ˜)**
- âœ… `detect_invoice_type()`: ëª…ì„¸ì„œ íƒ€ì… ê°ì§€ (GSC/HACIELO/UNKNOWN)
- âœ… `parse_gsc_invoice()`: GSC ëª…ì„¸ì„œ ì „ìš© íŒŒì‹± (ë©”íƒ€ë°ì´í„° + í…Œì´ë¸”)
- âœ… `parse_gsc_table()`: GSC í…Œì´ë¸” íŒŒì‹± (ë‹¤ì¤‘ ì›ë‘ í•­ëª©)
- âœ… `parse_gsc_table_row()`: GSC í…Œì´ë¸” í–‰ íŒŒì‹± (ì •ê·œì‹)
- âœ… `parse_invoice()`: í†µí•© íŒŒì‹± (íƒ€ì… ìë™ ê°ì§€)

**Task 2-4: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±**
- âœ… `test_image_utils.py` (198 lines, 15ê°œ í…ŒìŠ¤íŠ¸)
  - ì´ë¯¸ì§€ ì „ì²˜ë¦¬, íšŒì „, ëŒ€ë¹„, ë…¸ì´ì¦ˆ, ì €ì¥/ë¡œë“œ, í†µí•© í…ŒìŠ¤íŠ¸
- âœ… `test_text_parser.py` (351 lines, 43ê°œ í…ŒìŠ¤íŠ¸)
  - ì •ê·œí™”, ì›ë‘ëª…/ìˆ˜ëŸ‰/ê°€ê²©/ë‚ ì§œ ì¶”ì¶œ, GSC íŒŒì‹±, ê²€ì¦
- âœ… **ì´ 58ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼**

**Task 2-5: í™˜ê²½ ìˆ˜ì •**
- âœ… NumPy í˜¸í™˜ì„± ë¬¸ì œ í•´ê²°: numpy 2.1.3 â†’ numpy<2 (opencv-python)
- âœ… requirements.txt ì—…ë°ì´íŠ¸

**ì»¤ë°‹:**
```
21437b3d feat: Phase 2 ì™„ë£Œ - ì´ë¯¸ì§€ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹° êµ¬í˜„
```

**ê²€ì¦ ê¸°ì¤€:**
- âœ… ëª¨ë“  í•¨ìˆ˜ import ì„±ê³µ
- âœ… ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ í†µí•© í…ŒìŠ¤íŠ¸ í†µê³¼
- âœ… GSC ëª…ì„¸ì„œ íŒŒì‹± ë¡œì§ ê²€ì¦ í†µê³¼
- âœ… 58ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼ (100%)

**ê²°ê³¼:**
- âœ… Phase 2 ì™„ë£Œ (ì˜ˆìƒ ì‹œê°„: 4ì‹œê°„, ì‹¤ì œ ì‹œê°„: ~3ì‹œê°„)
- âœ… ë²„ì „ ìë™ ì—…ë°ì´íŠ¸: v0.31.0 â†’ v0.32.0 (MINOR)
- âœ… ì´ë¯¸ì§€ ì²˜ë¦¬ ë° í…ìŠ¤íŠ¸ íŒŒì‹± í™˜ê²½ êµ¬ì¶• ì™„ë£Œ, Phase 3 ì§„í–‰ ê°€ëŠ¥

---

## ğŸ“‹ ë‹¤ìŒ ì‘ì—… (ì§„í–‰ ì˜ˆì •)

### Phase 3: ì„œë¹„ìŠ¤ ê³„ì¸µ (4ì‹œê°„)
- `app/services/ocr_service.py`: OCR ìˆ˜í–‰, ë°ì´í„° íŒŒì‹±
- `app/services/invoice_service.py`: ì…ê³  ì²˜ë¦¬, ì´ë¯¸ì§€ ì €ì¥
- `app/services/learning_service.py`: ì‚¬ìš©ì í”¼ë“œë°± í•™ìŠµ

### Phase 4: UI êµ¬í˜„ (4ì‹œê°„)
- `app/pages/ImageInvoiceUpload.py`: ì´ë¯¸ì§€ ì—…ë¡œë“œ, ê²°ê³¼ í™•ì¸, ì…ê³  í™•ì •

### Phase 5: í•™ìŠµ ê¸°ëŠ¥ (2ì‹œê°„)
- ì‚¬ìš©ì ìˆ˜ì • ë‚´ì—­ ì €ì¥ ë° ì œì•ˆ

### Phase 6: í…ŒìŠ¤íŠ¸ & ë¬¸ì„œí™” (2ì‹œê°„)
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, í†µí•© í…ŒìŠ¤íŠ¸
- ì‚¬ìš©ì ê°€ì´ë“œ, ì•„í‚¤í…ì²˜ ë¬¸ì„œ

---

## ğŸ“Š í”„ë¡œì íŠ¸ í˜„í™©

### ë²„ì „ ì •ë³´
- **ì‹œì‘ ë²„ì „**: v0.30.3
- **í˜„ì¬ ë²„ì „**: v0.32.0 (MINOR) âœ…
- **ëª©í‘œ ì™„ë£Œ**: Phase 3~6 ì™„ë£Œ í›„ (ì•½ 1.5ì¼ ë‚¨ìŒ)

### ì£¼ìš” ë³€ê²½ì‚¬í•­ (v0.31.0 â†’ v0.32.0)

**v0.31.0 (Phase 1 ì™„ë£Œ):**
- ì‹ ê·œ í…Œì´ë¸”: Invoice, InvoiceItem, InvoiceLearning (3ê°œ)
- ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ ë° ë§ˆì´ê·¸ë ˆì´ì…˜

**v0.32.0 (Phase 2 ì™„ë£Œ) âœ…:**
- ì‹ ê·œ ìœ í‹¸ë¦¬í‹°: image_utils (8ê°œ í•¨ìˆ˜), text_parser (18ê°œ í•¨ìˆ˜)
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: 58ê°œ (100% í†µê³¼)
- NumPy í˜¸í™˜ì„± ìˆ˜ì •: numpy<2

### ì™„ë£Œëœ Phase
- âœ… Phase 0: í™˜ê²½ ì„¤ì • (1ì‹œê°„)
- âœ… Phase 1: ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ (2ì‹œê°„)
- âœ… Phase 2: ì´ë¯¸ì§€ ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹° (4ì‹œê°„) â† **ì™„ë£Œ**

### ë‚¨ì€ Phase
- Phase 3: ì„œë¹„ìŠ¤ ê³„ì¸µ (4ì‹œê°„)
- Phase 4: UI êµ¬í˜„ (4ì‹œê°„)
- Phase 5: í•™ìŠµ ê¸°ëŠ¥ (2ì‹œê°„)
- Phase 6: í…ŒìŠ¤íŠ¸ & ë¬¸ì„œí™” (2ì‹œê°„)

### ìƒ˜í”Œ ì´ë¯¸ì§€ ë¶„ì„ ì™„ë£Œ
- **GSC ëª…ì„¸ì„œ**: 10ê°œ (í‘œì¤€í™”ëœ ì–‘ì‹, ì£¼ë ¥ íƒ€ì…)
- **HACIELO ëª…ì„¸ì„œ**: 1ê°œ (ë¹„í‘œì¤€ ì–‘ì‹)
- **ëª©í‘œ ì •í™•ë„**: GSC 85%+, HACIELO 70%+

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ
- **í”Œëœ**: `Documents/Planning/IMAGE_INVOICE_UPLOAD_PLAN.md` (60KB, 1,662 lines)
- **ê°œë°œ ë°©ë²•ë¡ **: 7ë‹¨ê³„ ì²´ê³„ì  ê°œë°œ (Constitution â†’ Specify â†’ Clarify â†’ Plan â†’ Tasks â†’ Implement â†’ Analyze)

---

## ğŸ“ ë©”ëª¨
- Phase 0 ì™„ë£Œ í›„ ë¬¸ì„œ 4ì¢… ì„¸íŠ¸ ì—…ë°ì´íŠ¸ ì§„í–‰ ì¤‘
- ì¤‘ê°„ì¤‘ê°„ ì„¸ì…˜ ì¢…ë£Œ ì „ ë¬¸ì„œ ì—…ë°ì´íŠ¸ í•„ìˆ˜ (ì‚¬ìš©ì ìš”ì²­)
- ê° Phase ì™„ë£Œ í›„ ì»¤ë°‹ ë° ë¬¸ì„œ ë™ê¸°í™” ì˜ˆì •

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-13 (Phase 2 ì™„ë£Œ, í˜„ì¬ v0.32.0)
