# ë‹¤ì¤‘ ì£¼ë¬¸ë²ˆí˜¸ ëª…ì„¸ì„œ ì²˜ë¦¬ ì‹œìŠ¤í…œ ì„¤ê³„ì•ˆ

> **ì‘ì„±ì¼**: 2025-12-28
> **ìµœì¢… ìˆ˜ì •**: 2025-12-28
> **ë²„ì „**: 1.1.0
> **ìƒíƒœ**: ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ (ìˆ˜ì •ì‚¬í•­ ë°˜ì˜ ì™„ë£Œ)
>
> **ë³€ê²½ ì´ë ¥**:
> - v1.1.0 (2025-12-28): ì·¨ì†Œ í”Œë¡œìš° ê°œì„  + ì™„ë£Œ í›„ ë™ì‘ ë³€ê²½
> - v1.0.0 (2025-12-28): ì´ˆê¸° ì„¤ê³„ì•ˆ ì‘ì„±

---

## ğŸ“Œ ê°œìš”

### ë¬¸ì œ ì •ì˜
í˜„ì¬ ì‹œìŠ¤í…œì€ í•˜ë‚˜ì˜ ì…ê³  ëª…ì„¸ì„œì— **ë‹¨ì¼ ì£¼ë¬¸ë²ˆí˜¸**ë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ ì‹¤ë¬´ì—ì„œëŠ” **í•˜ë‚˜ì˜ ëª…ì„¸ì„œì— ì—¬ëŸ¬ ì£¼ë¬¸ë²ˆí˜¸**ê°€ í¬í•¨ëœ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤.

**ì˜ˆì‹œ**: `/coffee_bean_receiving_Specification/IMG_1660.JPG`
- ì£¼ë¬¸ë²ˆí˜¸ #1: `20251108-8B7C2` (ë¸Œë¼ì§ˆ ì‚°í† ìŠ¤ 40kg, 494,000ì›)
- ì£¼ë¬¸ë²ˆí˜¸ #2: `20250926-8BD28` (ì—í‹°ì˜¤í”¼ì•„ ëª¨ëª¨ë¼ 20kg, 430,000ì›)
- ì£¼ë¬¸ë²ˆí˜¸ #3: `20250822-9533C` (ì—í‹°ì˜¤í”¼ì•„ ëª¨ëª¨ë¼ 40kg, 870,000ì›)

### ì„¤ê³„ ì² í•™
âŒ **ìë™ ë¶„í• **: ì‹œìŠ¤í…œì´ ì„ì˜ë¡œ 3ê°œ ë¬¸ì„œë¡œ ë¶„ë¦¬
âœ… **ì‚¬ìš©ì ì„ íƒì  ì²˜ë¦¬**: ì‚¬ìš©ìê°€ ê° ì£¼ë¬¸ì„ ê²€ì¦í•˜ê³  ê°œë³„ ì…ê³  ì²˜ë¦¬

---

## ğŸ¯ í•µì‹¬ ìš”êµ¬ì‚¬í•­

1. **OCR ë¶„ì„ ì™„ë£Œ ì‹œ** ì£¼ë¬¸ë²ˆí˜¸ê°€ 2ê°œ ì´ìƒì´ë©´ ì•ˆë‚´ì°½ í‘œì‹œ
2. **ì•ˆë‚´ì°½**: "3ê°œì˜ ì£¼ë¬¸ë²ˆí˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤" + ìŠ¹ì¸ ë²„íŠ¼
3. **ìŠ¹ì¸ ì‹œ**: ì£¼ë¬¸ë³„ë¡œ ê·¸ë£¹í™”ëœ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
4. **ê°œë³„ ì²˜ë¦¬**: ì‚¬ìš©ìê°€ ê° ì£¼ë¬¸ì„ ì„ íƒí•˜ì—¬ "ì¶”ê°€" í´ë¦­
5. **ê²½ê³ ë¬¸**: "ì¶”ê°€í•˜ë©´ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œë©ë‹ˆë‹¤. ì·¨ì†Œ ë¶ˆê°€ëŠ¥" í‘œì‹œ
6. **í™•ì¸ í›„**: í•´ë‹¹ ì£¼ë¬¸ë§Œ ì…ê³  ìƒì„¸ ì •ë³´ë¡œ ì „ì†¡ â†’ ì¬ê³  ì—…ë°ì´íŠ¸ â†’ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì„¤ê³„

### 1. Data Flow

```
ì‚¬ìš©ì ì´ë¯¸ì§€ ì—…ë¡œë“œ
    â†“
OCR ë¶„ì„ (Gemini/Claude)
    â†“
í›„ì²˜ë¦¬: order_groups ìƒì„±
    â†“
has_multiple_orders == true?
    â†“
YES â†’ Modal í‘œì‹œ ("3ê°œ ì£¼ë¬¸ ê°ì§€")
    â†“
ì‚¬ìš©ì ìŠ¹ì¸
    â†“
ì£¼ë¬¸ë³„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ (Accordion/Card)
    â†“
ì‚¬ìš©ì ì£¼ë¬¸ ì„ íƒ â†’ "ì¶”ê°€" ë²„íŠ¼ í´ë¦­
    â†“
ê²½ê³  Dialog ("ì·¨ì†Œ ë¶ˆê°€ëŠ¥")
    â†“
í™•ì¸ í´ë¦­
    â†“
POST /api/v1/inbound/confirm (í•´ë‹¹ ì£¼ë¬¸ë§Œ)
    â†“
ì¬ê³  ì—…ë°ì´íŠ¸ + ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ
    â†“
ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ? â†’ Inbound í˜ì´ì§€ ìœ ì§€ + ë°ì´í„° ì´ˆê¸°í™”
```

---

## ğŸ“Š ë°ì´í„° êµ¬ì¡°

### OCR ì‘ë‹µ ìŠ¤í‚¤ë§ˆ (ì‹ ê·œ í•„ë“œ)

```json
{
  "error": null,
  "has_multiple_orders": true,
  "total_order_count": 3,
  "order_groups": [
    {
      "order_number": "20251108-8B7C2",
      "order_date": "2025-11-08",
      "items": [
        {
          "bean_name": "ë¸Œë¼ì§ˆ ì‚°í† ìŠ¤ NY2 FC (2)",
          "quantity": 40,
          "unit": "kg",
          "unit_price": 12350,
          "amount": 494000,
          "order_number": "20251108-8B7C2"
        }
      ],
      "subtotal": 494000
    },
    {
      "order_number": "20250926-8BD28",
      "order_date": "2025-09-26",
      "items": [
        {
          "bean_name": "ì—í‹°ì˜¤í”¼ì•„ ëª¨ëª¨ë¼ ë‚´ì¶”ëŸ´ G1 (1)",
          "quantity": 20,
          "unit": "kg",
          "unit_price": 21500,
          "amount": 430000,
          "order_number": "20250926-8BD28"
        }
      ],
      "subtotal": 430000
    },
    {
      "order_number": "20250822-9533C",
      "order_date": "2025-08-22",
      "items": [
        {
          "bean_name": "(ì£¼ê°„ìƒë‘)ì—í‹°ì˜¤í”¼ì•„ ëª¨ëª¨ë¼ ë‚´ì¶”ëŸ´ G1 (2)",
          "quantity": 40,
          "unit": "kg",
          "unit_price": 21750,
          "amount": 870000,
          "order_number": "20250822-9533C"
        }
      ],
      "subtotal": 870000
    }
  ],
  "document_info": { ... },
  "supplier": { ... },
  "amounts": {
    "total_amount": 1794000
  }
}
```

---

## ğŸ¨ UI/UX ì„¤ê³„

### Phase 1: ì•ˆë‚´ Modal

**íŠ¸ë¦¬ê±° ì¡°ê±´**: `has_multiple_orders === true`

```tsx
<AlertDialog open={showMultiOrderModal}>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>
        <AlertTriangle className="w-6 h-6 text-amber-500" />
        ë‹¤ì¤‘ ì£¼ë¬¸ ê°ì§€
      </AlertDialogTitle>
      <AlertDialogDescription>
        ì´ ëª…ì„¸ì„œì—ëŠ” <strong>3ê°œì˜ ì£¼ë¬¸ ë²ˆí˜¸</strong>ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
        ê° ì£¼ë¬¸ì„ ê°œë³„ì ìœ¼ë¡œ ì…ê³  ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </AlertDialogDescription>
    </AlertDialogHeader>

    <div className="space-y-2">
      {/* ì£¼ë¬¸ ë²ˆí˜¸ ëª©ë¡ ë¯¸ë¦¬ë³´ê¸° */}
      <div className="p-3 bg-latte-50 rounded-lg">
        <Badge>20251108-8B7C2</Badge>
        <span className="ml-2">1ê°œ í’ˆëª©</span>
        <span className="ml-2 font-mono">494,000ì›</span>
      </div>
      <div className="p-3 bg-latte-50 rounded-lg">
        <Badge>20250926-8BD28</Badge>
        <span className="ml-2">1ê°œ í’ˆëª©</span>
        <span className="ml-2 font-mono">430,000ì›</span>
      </div>
      <div className="p-3 bg-latte-50 rounded-lg">
        <Badge>20250822-9533C</Badge>
        <span className="ml-2">1ê°œ í’ˆëª©</span>
        <span className="ml-2 font-mono">870,000ì›</span>
      </div>
    </div>

    <AlertDialogFooter>
      <AlertDialogCancel onClick={handleCancelMultiOrders}>ì·¨ì†Œ</AlertDialogCancel>
      <AlertDialogAction onClick={handleAcceptMultiOrders}>
        í™•ì¸ - ê°œë³„ ì²˜ë¦¬ ëª¨ë“œë¡œ ì „í™˜
      </AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>

{/* ğŸ†• ì·¨ì†Œ í™•ì¸ Dialog */}
<AlertDialog open={showCancelConfirmDialog}>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle className="text-amber-600">
        ì‘ì—… ì·¨ì†Œ í™•ì¸
      </AlertDialogTitle>
      <AlertDialogDescription>
        <div className="bg-amber-50 border-2 border-amber-200 rounded-lg p-4 mt-2">
          <p className="text-amber-900 font-bold">
            âš ï¸ ëª¨ë“  ë‚´ìš©ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤
          </p>
          <p className="text-sm text-amber-800 mt-2">
            ì§„í–‰ ì¤‘ì¸ OCR ë¶„ì„ ê²°ê³¼ê°€ ëª¨ë‘ ì‚­ì œë˜ë©°, ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
          </p>
        </div>
      </AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel onClick={() => setShowCancelConfirmDialog(false)}>
        ëŒì•„ê°€ê¸°
      </AlertDialogCancel>
      <AlertDialogAction
        onClick={confirmCancelWork}
        className="bg-amber-600 hover:bg-amber-700"
      >
        í™•ì¸ - ì‘ì—… ì·¨ì†Œ
      </AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

---

### Phase 2: ì£¼ë¬¸ë³„ ë¦¬ìŠ¤íŠ¸ (Accordion/Card)

**ìƒíƒœ**: `pendingOrders` (Array of OrderGroup)

```tsx
<div className="space-y-4">
  <div className="flex justify-between items-center mb-4">
    <h2 className="text-2xl font-bold">ì…ê³  ëŒ€ê¸° ì£¼ë¬¸ ëª©ë¡</h2>
    <Badge variant="secondary">
      {pendingOrders.length}ê°œ ì£¼ë¬¸ ëŒ€ê¸° ì¤‘
    </Badge>
  </div>

  {pendingOrders.map((orderGroup, index) => (
    <Card key={orderGroup.order_number} className="border-2">
      <CardHeader>
        <CardTitle className="flex justify-between items-center">
          <div>
            <Badge variant="outline" className="text-base">
              {orderGroup.order_number}
            </Badge>
            <span className="ml-3 text-sm text-gray-500">
              {orderGroup.order_date}
            </span>
          </div>
          <span className="font-mono font-bold text-lg">
            {orderGroup.subtotal.toLocaleString()}ì›
          </span>
        </CardTitle>
      </CardHeader>

      <CardContent>
        <table className="w-full">
          <thead className="bg-latte-50">
            <tr>
              <th className="text-left p-2">í’ˆëª…</th>
              <th className="text-right p-2">ìˆ˜ëŸ‰</th>
              <th className="text-right p-2">ë‹¨ê°€</th>
              <th className="text-right p-2">ê¸ˆì•¡</th>
            </tr>
          </thead>
          <tbody>
            {orderGroup.items.map((item, idx) => (
              <tr key={idx} className="border-t">
                <td className="p-2">{item.bean_name}</td>
                <td className="text-right p-2">
                  {item.quantity} {item.unit}
                </td>
                <td className="text-right p-2">
                  {item.unit_price.toLocaleString()}ì›
                </td>
                <td className="text-right p-2 font-bold">
                  {item.amount.toLocaleString()}ì›
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </CardContent>

      <CardFooter>
        <Button
          onClick={() => handleAddOrder(orderGroup, index)}
          className="w-full bg-green-600 hover:bg-green-700"
          size="lg"
        >
          <Plus className="w-5 h-5 mr-2" />
          ì´ ì£¼ë¬¸ ì…ê³  ì²˜ë¦¬í•˜ê¸°
        </Button>
      </CardFooter>
    </Card>
  ))}
</div>
```

---

### Phase 3: ê²½ê³  Dialog

**íŠ¸ë¦¬ê±°**: "ì¶”ê°€" ë²„íŠ¼ í´ë¦­

```tsx
<AlertDialog open={showConfirmDialog}>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle className="text-red-600 flex items-center gap-2">
        <AlertTriangle className="w-6 h-6" />
        ì…ê³  ì²˜ë¦¬ í™•ì¸
      </AlertDialogTitle>
      <AlertDialogDescription>
        <div className="space-y-3">
          <p className="font-bold text-base text-gray-900">
            ì£¼ë¬¸ë²ˆí˜¸: {selectedOrder?.order_number}
          </p>
          <p className="text-sm text-gray-600">
            ì´ {selectedOrder?.items.length}ê°œ í’ˆëª© /
            {selectedOrder?.subtotal.toLocaleString()}ì›
          </p>

          <div className="bg-red-50 border-2 border-red-200 rounded-lg p-4">
            <p className="text-red-900 font-bold mb-2">
              âš ï¸ ì£¼ì˜ì‚¬í•­
            </p>
            <ul className="list-disc list-inside text-sm text-red-800 space-y-1">
              <li><strong>ì…ê³  ì²˜ë¦¬ í›„ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œë©ë‹ˆë‹¤</strong></li>
              <li><strong>ì·¨ì†Œ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤</strong></li>
              <li>ì¬ê³ ê°€ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤</li>
              <li>ì…ê³  ë‚´ì—­ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë©ë‹ˆë‹¤</li>
            </ul>
          </div>
        </div>
      </AlertDialogDescription>
    </AlertDialogHeader>

    <AlertDialogFooter>
      <AlertDialogCancel>ì·¨ì†Œ</AlertDialogCancel>
      <AlertDialogAction
        onClick={() => confirmAddOrder(selectedOrderIndex)}
        className="bg-red-600 hover:bg-red-700"
      >
        í™•ì¸ - ì…ê³  ì²˜ë¦¬
      </AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

---

## ğŸ’» ë°±ì—”ë“œ êµ¬í˜„

### 1. Database Migration

**íŒŒì¼**: `backend/app/models/inbound_item.py`

```python
# ì‹ ê·œ ì»¬ëŸ¼ ì¶”ê°€
class InboundItem(Base):
    __tablename__ = "inbound_items"

    # ... ê¸°ì¡´ í•„ë“œë“¤

    # NEW: ê° í•­ëª©ë³„ ì£¼ë¬¸ë²ˆí˜¸
    order_number = Column(String(100), nullable=True, index=True)
```

**Migration SQL**:
```sql
ALTER TABLE inbound_items
ADD COLUMN order_number VARCHAR(100);

CREATE INDEX idx_inbound_items_order_number
ON inbound_items(order_number);
```

---

### 2. OCR í”„ë¡¬í”„íŠ¸ ìˆ˜ì •

**íŒŒì¼**: `backend/app/resources/ocr_prompt_structure.json`

```json
{
  "items": [
    {
      "item_number": "ìˆœë²ˆ, No",
      "order_number": "ì£¼ë¬¸ë²ˆí˜¸, Order No (YYYYMMDD-XXXXX í˜•ì‹)",
      "bean_name": "í’ˆëª…, ì›ë‘ëª…",
      "quantity": "ìˆ˜ëŸ‰ (Number)",
      "unit": "ë‹¨ìœ„ (kg, bag, etc.)",
      "unit_price": "ë‹¨ê°€ (Number)",
      "amount": "ê¸ˆì•¡ (Number)"
    }
  ]
}
```

**í”„ë¡¬í”„íŠ¸ ì¶”ê°€ ì§€ì‹œì‚¬í•­**:
```
STEP 5-1. ORDER NUMBER EXTRACTION (NEW)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
If the document contains MULTIPLE order numbers (ì£¼ë¬¸ë²ˆí˜¸) for different items:

1. Each item MUST include its corresponding "order_number" field.
2. Format: YYYYMMDD-XXXXX (e.g., "20251108-8B7C2")
3. If order number appears in a column header or next to the item, extract it.
4. If unclear, extract from context (date + identifier pattern).

Example:
- Row 1: "20251108-8B7C2 ë¸Œë¼ì§ˆ ì‚°í† ìŠ¤..." â†’ order_number: "20251108-8B7C2"
- Row 2: "20250926-8BD28 ì—í‹°ì˜¤í”¼ì•„..." â†’ order_number: "20250926-8BD28"
```

---

### 3. OCR í›„ì²˜ë¦¬ ë¡œì§

**íŒŒì¼**: `backend/app/services/ocr_service.py`

```python
def _post_process_ocr_result(self, result: dict) -> dict:
    """
    OCR ê²°ê³¼ë¥¼ í›„ì²˜ë¦¬í•˜ì—¬ ì£¼ë¬¸ë³„ë¡œ ê·¸ë£¹í™”

    Returns:
        Enhanced result with:
        - has_multiple_orders: bool
        - total_order_count: int
        - order_groups: List[OrderGroup]
    """
    items = result.get("items", [])

    if not items:
        result["has_multiple_orders"] = False
        result["total_order_count"] = 0
        result["order_groups"] = []
        return result

    # ì£¼ë¬¸ë²ˆí˜¸ë¡œ ê·¸ë£¹í™”
    order_groups = {}

    for item in items:
        order_num = item.get("order_number") or "UNKNOWN"

        if order_num not in order_groups:
            order_groups[order_num] = {
                "order_number": order_num,
                "order_date": None,  # Extract from order_number (YYYYMMDD)
                "items": [],
                "subtotal": 0
            }

        order_groups[order_num]["items"].append(item)
        order_groups[order_num]["subtotal"] += item.get("amount", 0)

    # ì£¼ë¬¸ ë‚ ì§œ ì¶”ì¶œ (YYYYMMDD-XXXXX í˜•ì‹ì—ì„œ)
    import re
    for group in order_groups.values():
        order_num = group["order_number"]
        match = re.match(r"^(\d{4})(\d{2})(\d{2})", order_num)
        if match:
            year, month, day = match.groups()
            group["order_date"] = f"{year}-{month}-{day}"

    # ê²°ê³¼ enrichment
    order_groups_list = list(order_groups.values())
    result["has_multiple_orders"] = len(order_groups_list) > 1
    result["total_order_count"] = len(order_groups_list)
    result["order_groups"] = order_groups_list

    return result

# analyze_image_stream()ì—ì„œ í˜¸ì¶œ
async def analyze_image_stream(self, image_bytes: bytes, mime_type: str = "image/jpeg"):
    # ... ê¸°ì¡´ ë¡œì§

    result_json = self._clean_and_parse_json(text_result)

    # ğŸ†• í›„ì²˜ë¦¬ ì¶”ê°€
    result_json = self._post_process_ocr_result(result_json)

    yield {"status": "complete", "data": result_json}
```

---

## ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„

### 1. State ê´€ë¦¬

**íŒŒì¼**: `frontend/app/inventory/inbound/page.tsx`

```typescript
'use client';

import { useState } from 'react';

interface OrderGroup {
  order_number: string;
  order_date: string;
  items: any[];
  subtotal: number;
}

export default function InboundPage() {
  // ê¸°ì¡´ state
  const [ocrResult, setOcrResult] = useState(null);

  // ğŸ†• ë‹¤ì¤‘ ì£¼ë¬¸ ê´€ë ¨ state
  const [hasMultipleOrders, setHasMultipleOrders] = useState(false);
  const [totalOrderCount, setTotalOrderCount] = useState(0);
  const [orderGroups, setOrderGroups] = useState<OrderGroup[]>([]);

  // ğŸ†• Modal state
  const [showMultiOrderModal, setShowMultiOrderModal] = useState(false);
  const [showConfirmDialog, setShowConfirmDialog] = useState(false);
  const [showCancelConfirmDialog, setShowCancelConfirmDialog] = useState(false);  // ğŸ†• ì·¨ì†Œ í™•ì¸

  // ğŸ†• Pending orders (ì‚¬ìš©ìê°€ ì•„ì§ ì²˜ë¦¬í•˜ì§€ ì•Šì€ ì£¼ë¬¸ë“¤)
  const [pendingOrders, setPendingOrders] = useState<OrderGroup[]>([]);
  const [selectedOrderIndex, setSelectedOrderIndex] = useState<number | null>(null);

  // ... ê¸°ì¡´ ë¡œì§
}
```

---

### 2. OCR ì™„ë£Œ í›„ ì²˜ë¦¬

```typescript
const handleOCRComplete = (result: any) => {
  setOcrResult(result);

  // ğŸ†• ë‹¤ì¤‘ ì£¼ë¬¸ ì²´í¬
  if (result.has_multiple_orders) {
    setHasMultipleOrders(true);
    setTotalOrderCount(result.total_order_count);
    setOrderGroups(result.order_groups);
    setShowMultiOrderModal(true);  // Modal í‘œì‹œ
  } else {
    // ê¸°ì¡´ í”Œë¡œìš° (ë‹¨ì¼ ì£¼ë¬¸)
    // ...
  }
};

const handleAcceptMultiOrders = () => {
  setShowMultiOrderModal(false);
  setPendingOrders([...orderGroups]);  // ëª¨ë“  ì£¼ë¬¸ì„ ëŒ€ê¸° ë¦¬ìŠ¤íŠ¸ë¡œ
};

const handleCancelMultiOrders = () => {
  setShowMultiOrderModal(false);
  setShowCancelConfirmDialog(true);  // ğŸ†• ì·¨ì†Œ í™•ì¸ Dialog í‘œì‹œ
};

const confirmCancelWork = () => {
  // ğŸ†• ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
  setOcrResult(null);
  setHasMultipleOrders(false);
  setOrderGroups([]);
  setPendingOrders([]);
  setShowCancelConfirmDialog(false);

  toast.info('ì‘ì—…ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤. ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
};
```

---

### 3. ê°œë³„ ì£¼ë¬¸ ì²˜ë¦¬

```typescript
const handleAddOrder = (orderGroup: OrderGroup, index: number) => {
  setSelectedOrderIndex(index);
  setShowConfirmDialog(true);
};

const confirmAddOrder = async (index: number) => {
  if (index === null) return;

  const orderGroup = pendingOrders[index];

  try {
    // POST /api/v1/inbound/confirm
    const response = await fetch('/api/v1/inbound/confirm', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        document: {
          contract_number: orderGroup.order_number,  // í•µì‹¬!
          supplier_name: ocrResult.supplier.name,
          supplier_id: selectedSupplierId,
          total_amount: orderGroup.subtotal,
          invoice_date: orderGroup.order_date,
        },
        items: orderGroup.items,  // í•´ë‹¹ ì£¼ë¬¸ì˜ itemsë§Œ
        supplier: ocrResult.supplier,
        // ... ê¸°íƒ€ í•„ë“œ
      })
    });

    if (!response.ok) {
      throw new Error('ì…ê³  ì²˜ë¦¬ ì‹¤íŒ¨');
    }

    // ì„±ê³µ: ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ
    setPendingOrders(prev => prev.filter((_, i) => i !== index));
    setShowConfirmDialog(false);

    toast.success(`${orderGroup.order_number} ì…ê³  ì²˜ë¦¬ ì™„ë£Œ`);

    // ğŸ†• ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ?
    if (pendingOrders.length === 1) {
      toast.success('ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ!');

      // /inventoryë¡œ ì´ë™ ëŒ€ì‹  ë°ì´í„° ì´ˆê¸°í™”
      setOcrResult(null);
      setHasMultipleOrders(false);
      setOrderGroups([]);
      setPendingOrders([]);

      // Inbound í˜ì´ì§€ ìœ ì§€, ìƒˆ ëª…ì„¸ì„œ ì—…ë¡œë“œ ê°€ëŠ¥ ìƒíƒœ
    }

  } catch (error) {
    toast.error('ì…ê³  ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ');
    console.error(error);
  }
};
```

---

## ğŸ“‹ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Backend (Agent 3)

- [ ] **DB Migration**
  - [ ] `inbound_items.order_number` ì»¬ëŸ¼ ì¶”ê°€ (VARCHAR 100, nullable)
  - [ ] Index ìƒì„±: `idx_inbound_items_order_number`

- [ ] **OCR í”„ë¡¬í”„íŠ¸ ìˆ˜ì •**
  - [ ] `ocr_prompt_structure.json`ì— `order_number` í•„ë“œ ì¶”ê°€
  - [ ] STEP 5-1 ì§€ì‹œì‚¬í•­ ì¶”ê°€ (ë‹¤ì¤‘ ì£¼ë¬¸ë²ˆí˜¸ ì¶”ì¶œ)

- [ ] **OCR Service ê°œì„ **
  - [ ] `_post_process_ocr_result()` í•¨ìˆ˜ êµ¬í˜„
  - [ ] `analyze_image_stream()`ì—ì„œ í›„ì²˜ë¦¬ í˜¸ì¶œ
  - [ ] ì£¼ë¬¸ ë‚ ì§œ ìë™ ì¶”ì¶œ ë¡œì§ (YYYYMMDD íŒŒì‹±)

- [ ] **API ì‘ë‹µ ìŠ¤í‚¤ë§ˆ**
  - [ ] `has_multiple_orders`, `total_order_count`, `order_groups` í•„ë“œ ì¶”ê°€

---

### Frontend (Agent 2)

- [ ] **State ê´€ë¦¬**
  - [ ] `hasMultipleOrders`, `orderGroups`, `pendingOrders` state ì¶”ê°€

- [ ] **UI ì»´í¬ë„ŒíŠ¸**
  - [ ] Multi-Order Detection Modal êµ¬í˜„
  - [ ] Cancel Confirmation Dialog êµ¬í˜„ (ğŸ†• ì·¨ì†Œ í™•ì¸)
  - [ ] Pending Orders List (Accordion/Card) êµ¬í˜„
  - [ ] Add Order Confirmation Dialog êµ¬í˜„ (ì…ê³  ì²˜ë¦¬ ê²½ê³ ë¬¸)

- [ ] **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
  - [ ] `handleOCRComplete()` - ë‹¤ì¤‘ ì£¼ë¬¸ ê°ì§€ ë¡œì§
  - [ ] `handleAcceptMultiOrders()` - ìŠ¹ì¸ í›„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
  - [ ] `handleCancelMultiOrders()` - ğŸ†• ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ì‹œ í™•ì¸ Dialog í‘œì‹œ
  - [ ] `confirmCancelWork()` - ğŸ†• ì·¨ì†Œ í™•ì¸ í›„ ë°ì´í„° ì´ˆê¸°í™”
  - [ ] `handleAddOrder()` - ê°œë³„ ì£¼ë¬¸ ì„ íƒ
  - [ ] `confirmAddOrder()` - ì…ê³  ì²˜ë¦¬ ë° ë¦¬ìŠ¤íŠ¸ ì‚­ì œ

- [ ] **UX ê°œì„ **
  - [ ] Toast ì•Œë¦¼ (ì„±ê³µ/ì‹¤íŒ¨)
  - [ ] ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ ì‹œ ë°ì´í„° ì´ˆê¸°í™” (Inbound í˜ì´ì§€ ìœ ì§€)
  - [ ] ì·¨ì†Œ ì‹œ í™•ì¸ Dialog í‘œì‹œ
  - [ ] Loading state ì²˜ë¦¬

---

### Testing

- [ ] **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**
  - [ ] `_post_process_ocr_result()` í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
  - [ ] ì£¼ë¬¸ ë‚ ì§œ ì¶”ì¶œ ë¡œì§ í…ŒìŠ¤íŠ¸

- [ ] **í†µí•© í…ŒìŠ¤íŠ¸**
  - [ ] Mock OCR ë°ì´í„°ë¡œ 3ê°œ ì£¼ë¬¸ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
  - [ ] 1ê°œ ì£¼ë¬¸ â†’ ê¸°ì¡´ í”Œë¡œìš° ì •ìƒ ì‘ë™ í™•ì¸

- [ ] **E2E í…ŒìŠ¤íŠ¸**
  - [ ] ì´ë¯¸ì§€ ì—…ë¡œë“œ â†’ OCR â†’ Modal â†’ ê°œë³„ ì²˜ë¦¬ â†’ ì™„ë£Œ
  - [ ] ì¤‘ê°„ì— ì·¨ì†Œ ì‹œë‚˜ë¦¬ì˜¤
  - [ ] ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ í”Œë¡œìš°

---

## ğŸ”„ í”Œë¡œìš° ë‹¤ì´ì–´ê·¸ë¨ (ìƒì„¸)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ START: ì‚¬ìš©ìê°€ ëª…ì„¸ì„œ ì´ë¯¸ì§€ ì—…ë¡œë“œ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCR ë¶„ì„ ì‹œì‘ (Gemini/Claude)                         â”‚
â”‚ - ì´ë¯¸ì§€ íŒŒì‹±                                         â”‚
â”‚ - items ë°°ì—´ ì¶”ì¶œ                                     â”‚
â”‚ - ê° itemì˜ order_number ì¶”ì¶œ                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend í›„ì²˜ë¦¬: _post_process_ocr_result()            â”‚
â”‚ - itemsë¥¼ order_numberë¡œ ê·¸ë£¹í™”                       â”‚
â”‚ - order_groups ìƒì„± (ì£¼ë¬¸ë³„ items + subtotal)         â”‚
â”‚ - has_multiple_orders í”Œë˜ê·¸ ì„¤ì •                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â–¼
              [ì£¼ë¬¸ ê°œìˆ˜ í™•ì¸]
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
   1ê°œ ì£¼ë¬¸                   2ê°œ ì´ìƒ ì£¼ë¬¸
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê¸°ì¡´ í”Œë¡œìš°   â”‚      â”‚ ğŸ†• MODAL í‘œì‹œ                   â”‚
â”‚ (ë³€ê²½ ì—†ìŒ)   â”‚      â”‚ "3ê°œì˜ ì£¼ë¬¸ë²ˆí˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ - ì£¼ë¬¸ ëª©ë¡ ë¯¸ë¦¬ë³´ê¸°             â”‚
                      â”‚ - [ì·¨ì†Œ] [í™•ì¸] ë²„íŠ¼             â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â–¼
                        [ì‚¬ìš©ì ë²„íŠ¼ ì„ íƒ]
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚
                  [ì·¨ì†Œ]                    [í™•ì¸]
                    â”‚                         â”‚
                    â–¼                         â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ğŸ†• ì·¨ì†Œ í™•ì¸ Dialog â”‚    â”‚ ê°œë³„ ì²˜ë¦¬ ëª¨ë“œ ì§„ì…   â”‚
         â”‚ "ëª¨ë“  ë‚´ìš© ì´ˆê¸°í™”"  â”‚    â”‚ pendingOrders ì„¤ì •   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼                         â–¼
           [í™•ì¸ - ì‘ì—… ì·¨ì†Œ]
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ë°ì´í„° ì´ˆê¸°í™”       â”‚
         â”‚ Inbound í˜ì´ì§€ ìœ ì§€ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚ ğŸ†• ì£¼ë¬¸ë³„ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ     â”‚
                                   â”‚ (Accordion/Card UI)      â”‚
                                   â”‚ - ì£¼ë¬¸ #1 (Card)         â”‚
                                   â”‚ - ì£¼ë¬¸ #2 (Card)         â”‚
                                   â”‚ - ì£¼ë¬¸ #3 (Card)         â”‚
                                   â”‚ ê° Cardì— [ì¶”ê°€] ë²„íŠ¼    â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â–¼
                                   [ì‚¬ìš©ì ì£¼ë¬¸ ì„ íƒ]
                                              â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â–¼                   â–¼                   â–¼
                    [ì£¼ë¬¸ #1 ì¶”ê°€]       [ì£¼ë¬¸ #2 ì¶”ê°€]       [ì£¼ë¬¸ #3 ì¶”ê°€]
                          â”‚                   â”‚                   â”‚
                          â–¼                   â–¼                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ ğŸ†• ê²½ê³  Dialog    â”‚ â”‚ ğŸ†• ê²½ê³  Dialog    â”‚ â”‚ ğŸ†• ê²½ê³  Dialog    â”‚
              â”‚ "ì·¨ì†Œ ë¶ˆê°€ëŠ¥"     â”‚ â”‚ "ì·¨ì†Œ ë¶ˆê°€ëŠ¥"     â”‚ â”‚ "ì·¨ì†Œ ë¶ˆê°€ëŠ¥"     â”‚
              â”‚ "ë¦¬ìŠ¤íŠ¸ ì‚­ì œ"     â”‚ â”‚ "ë¦¬ìŠ¤íŠ¸ ì‚­ì œ"     â”‚ â”‚ "ë¦¬ìŠ¤íŠ¸ ì‚­ì œ"     â”‚
              â”‚ [ì·¨ì†Œ][í™•ì¸]      â”‚ â”‚ [ì·¨ì†Œ][í™•ì¸]      â”‚ â”‚ [ì·¨ì†Œ][í™•ì¸]      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â–¼                    â–¼                    â–¼
                   [í™•ì¸ í´ë¦­]          [í™•ì¸ í´ë¦­]          [í™•ì¸ í´ë¦­]
                        â”‚                    â”‚                    â”‚
                        â–¼                    â–¼                    â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ POST /inbound/confirmâ”‚ â”‚ POST /inbound/confirmâ”‚ â”‚ POST /inbound/confirmâ”‚
           â”‚ contract_number:     â”‚ â”‚ contract_number:     â”‚ â”‚ contract_number:     â”‚
           â”‚ "20251108-8B7C2"     â”‚ â”‚ "20250926-8BD28"     â”‚ â”‚ "20250822-9533C"     â”‚
           â”‚ items: [ë¸Œë¼ì§ˆ]      â”‚ â”‚ items: [ì—í‹°ì˜¤í”¼ì•„1] â”‚ â”‚ items: [ì—í‹°ì˜¤í”¼ì•„2] â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼                       â–¼                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ InboundDocument     â”‚ â”‚ InboundDocument     â”‚ â”‚ InboundDocument     â”‚
           â”‚ ìƒì„± (DB)           â”‚ â”‚ ìƒì„± (DB)           â”‚ â”‚ ìƒì„± (DB)           â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼                       â–¼                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ InventoryLog ìƒì„±   â”‚ â”‚ InventoryLog ìƒì„±   â”‚ â”‚ InventoryLog ìƒì„±   â”‚
           â”‚ ì¬ê³  +40kg          â”‚ â”‚ ì¬ê³  +20kg          â”‚ â”‚ ì¬ê³  +40kg          â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼                       â–¼                       â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ      â”‚ â”‚ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ      â”‚ â”‚ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ      â”‚
           â”‚ pendingOrders[0]    â”‚ â”‚ pendingOrders[0]    â”‚ â”‚ pendingOrders[0]    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼                       â–¼                       â–¼
                 [Toast: ì„±ê³µ]           [Toast: ì„±ê³µ]           [Toast: ì„±ê³µ]
                      â”‚                       â”‚                       â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â–¼
                                   [pendingOrders.length === 0?]
                                              â”‚
                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                                     YES             NO
                                      â”‚               â”‚
                                      â–¼               â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  [ëŒ€ê¸° ì¤‘]
                          â”‚ ğŸ†• ëª¨ë“  ì£¼ë¬¸ ì™„ë£Œ!     â”‚  (ì¶”ê°€ ì²˜ë¦¬ ê°€ëŠ¥)
                          â”‚ - Toast ë©”ì‹œì§€ í‘œì‹œ   â”‚
                          â”‚ - ë°ì´í„° ì´ˆê¸°í™”       â”‚
                          â”‚ - Inbound í˜ì´ì§€ ìœ ì§€ â”‚
                          â”‚ (ìƒˆ ëª…ì„¸ì„œ ì—…ë¡œë“œ ê°€ëŠ¥)â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¬ ì‚¬ìš©ì ì‹œë‚˜ë¦¬ì˜¤ ì˜ˆì‹œ

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ í”Œë¡œìš° (3ê°œ ì£¼ë¬¸ ëª¨ë‘ ì²˜ë¦¬)

1. **ì—…ë¡œë“œ**: ì‚¬ìš©ìê°€ IMG_1660.JPG ì—…ë¡œë“œ
2. **OCR**: "3ê°œì˜ ì£¼ë¬¸ë²ˆí˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤" Modal í‘œì‹œ
3. **ìŠ¹ì¸**: ì‚¬ìš©ìê°€ "í™•ì¸" í´ë¦­
4. **ë¦¬ìŠ¤íŠ¸ í‘œì‹œ**: 3ê°œ ì£¼ë¬¸ ì¹´ë“œ í‘œì‹œ
5. **ì²« ë²ˆì§¸ ì£¼ë¬¸ ì²˜ë¦¬**:
   - "20251108-8B7C2 ì¶”ê°€" í´ë¦­
   - ê²½ê³ ë¬¸ í™•ì¸
   - ì…ê³  ì™„ë£Œ â†’ ë¦¬ìŠ¤íŠ¸ì—ì„œ ì‚­ì œ
6. **ë‘ ë²ˆì§¸ ì£¼ë¬¸ ì²˜ë¦¬**: ë™ì¼ ê³¼ì • ë°˜ë³µ
7. **ì„¸ ë²ˆì§¸ ì£¼ë¬¸ ì²˜ë¦¬**: ë™ì¼ ê³¼ì • ë°˜ë³µ
8. **ì™„ë£Œ**: "ëª¨ë“  ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ!" Toast ë©”ì‹œì§€ â†’ Inbound í˜ì´ì§€ ìœ ì§€ + ë°ì´í„° ì´ˆê¸°í™” (ìƒˆ ëª…ì„¸ì„œ ì—…ë¡œë“œ ê°€ëŠ¥)

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¼ë¶€ë§Œ ì²˜ë¦¬ (ë‚˜ë¨¸ì§€ëŠ” ë³´ë¥˜)

1. **ì—…ë¡œë“œ**: IMG_1660.JPG ì—…ë¡œë“œ
2. **OCR**: Modal í‘œì‹œ â†’ ìŠ¹ì¸
3. **ì²« ë²ˆì§¸ ì£¼ë¬¸ë§Œ ì²˜ë¦¬**: 20251108-8B7C2 ì…ê³ 
4. **ë‚˜ë¨¸ì§€ ë³´ë¥˜**: ë¦¬ìŠ¤íŠ¸ì— 2ê°œ ì£¼ë¬¸ ë‚¨ì•„ìˆìŒ
5. **ë‚˜ì¤‘ì— ì²˜ë¦¬**: ì‚¬ìš©ìê°€ ë‹¤ì‹œ ì™€ì„œ ë‚¨ì€ ì£¼ë¬¸ ì²˜ë¦¬ ê°€ëŠ¥
   - âš ï¸ **ì œì•½**: ìƒˆë¡œê³ ì¹¨ ì‹œ ë°ì´í„° ì†ì‹¤ (Session Storage í•„ìš” ì‹œ ì¶”ê°€ êµ¬í˜„)

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì·¨ì†Œ

1. **ì—…ë¡œë“œ**: IMG_1660.JPG ì—…ë¡œë“œ
2. **OCR**: "3ê°œì˜ ì£¼ë¬¸ë²ˆí˜¸ê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤" Modal í‘œì‹œ
3. **ì·¨ì†Œ**: "ì·¨ì†Œ" ë²„íŠ¼ í´ë¦­
4. **í™•ì¸ Dialog**: "âš ï¸ ëª¨ë“  ë‚´ìš©ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤" ê²½ê³  í‘œì‹œ
5. **í™•ì¸**: "í™•ì¸ - ì‘ì—… ì·¨ì†Œ" í´ë¦­
6. **ê²°ê³¼**: OCR ë¶„ì„ ê²°ê³¼ ëª¨ë‘ ì‚­ì œ, Inbound í˜ì´ì§€ ì´ˆê¸° ìƒíƒœë¡œ ë³µì›

---

## ğŸ”§ ì¶”ê°€ ê³ ë ¤ì‚¬í•­

### 1. Session Persistence (ì„ íƒ ì‚¬í•­)
í˜„ì¬ ì„¤ê³„ëŠ” **ë©”ëª¨ë¦¬ ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬**ì…ë‹ˆë‹¤.
ìƒˆë¡œê³ ì¹¨ ì‹œ `pendingOrders` ì†ì‹¤ â†’ ì‚¬ìš©ìê°€ ë‹¤ì‹œ OCR ìˆ˜í–‰ í•„ìš”

**ê°œì„ ì•ˆ**:
```typescript
// Session Storageì— ì €ì¥
useEffect(() => {
  if (pendingOrders.length > 0) {
    sessionStorage.setItem('pendingOrders', JSON.stringify(pendingOrders));
  }
}, [pendingOrders]);

// í˜ì´ì§€ ë¡œë“œ ì‹œ ë³µì›
useEffect(() => {
  const saved = sessionStorage.getItem('pendingOrders');
  if (saved) {
    setPendingOrders(JSON.parse(saved));
  }
}, []);
```

---

### 2. ì£¼ë¬¸ ìƒíƒœ í‘œì‹œ
ë¦¬ìŠ¤íŠ¸ì— ê° ì£¼ë¬¸ì˜ ì²˜ë¦¬ ìƒíƒœ í‘œì‹œ:
- ğŸŸ¢ **ëŒ€ê¸° ì¤‘** (Pending)
- ğŸ”µ **ì²˜ë¦¬ ì¤‘** (Processing)
- âœ… **ì™„ë£Œ** (Completed)

---

### 3. Batch Processing (ì„ íƒ ì‚¬í•­)
"ëª¨ë‘ ì…ê³  ì²˜ë¦¬" ë²„íŠ¼ ì¶”ê°€:
```tsx
<Button onClick={handleBatchProcess}>
  <CheckCircle className="w-4 h-4 mr-2" />
  ëª¨ë“  ì£¼ë¬¸ ì¼ê´„ ì²˜ë¦¬
</Button>
```

---

## ğŸ“ ìŠ¹ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ë©”ë‹ˆì €ë‹˜ ìŠ¹ì¸ ì „ í™•ì¸ì‚¬í•­**:

- [ ] OCR ë¶„ì„ ì‹œ ì£¼ë¬¸ë³„ ê·¸ë£¹í™” ë¡œì§ ì´í•´
- [ ] Modal â†’ ë¦¬ìŠ¤íŠ¸ â†’ ê²½ê³  â†’ ì…ê³  í”Œë¡œìš° í™•ì¸
- [ ] "ì·¨ì†Œ ë¶ˆê°€ëŠ¥" ê²½ê³ ë¬¸ ì ì ˆì„± ê²€í† 
- [ ] UI/UX ë””ìì¸ ë°©í–¥ í™•ì¸
- [ ] ì¶”ê°€ ìš”êµ¬ì‚¬í•­ ë˜ëŠ” ë³€ê²½ì‚¬í•­ ìˆëŠ”ì§€ í™•ì¸

---

## ğŸ“… ë‹¤ìŒ ë‹¨ê³„

**ìŠ¹ì¸ í›„ ì§„í–‰ ìˆœì„œ**:

1. **ê°€ìƒ í…ŒìŠ¤íŠ¸** (Mock Data)
   - OCR ì‘ë‹µ Mock JSON ìƒì„±
   - Frontend ë¡œì§ í…ŒìŠ¤íŠ¸
   - í”Œë¡œìš° ê²€ì¦

2. **ì‹¤ì œ êµ¬í˜„**
   - Backend: DB Migration + OCR ìˆ˜ì •
   - Frontend: UI ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
   - E2E í…ŒìŠ¤íŠ¸

3. **ë°°í¬**
   - Staging í™˜ê²½ í…ŒìŠ¤íŠ¸
   - Production ë°°í¬

---

**ì‘ì„±ì**: Claude Sonnet 4.5
**ê²€í† ì**: ë©”ë‹ˆì €
**ìŠ¹ì¸ ìƒíƒœ**: ğŸŸ¡ ëŒ€ê¸° ì¤‘
