# Render.com 배포 설정 - TheMoon 프로젝트
version: "1"
projects:
- name: themoon
  environments:
  - name: production
    services:
    # Backend API (FastAPI)
    - type: web
      name: themoon-api
      runtime: python
      repo: https://github.com/usermaum/Themoon
      branch: claude/sync-deeply-from-main-01PSZYknDEZU9i7fVmE9TX4S
      plan: free
      envVars:
      - key: BACKEND_CORS_ORIGINS
        value: '["https://themoon-frontend.onrender.com","http://localhost:3000"]'
      - key: DEBUG
        value: "false"
      - key: SECRET_KEY
        generateValue: true
      - key: DATABASE_URL
        fromDatabase:
          name: themoon-db
          property: connectionString
      region: oregon
      buildCommand: pip install -r requirements.txt
      startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
      healthCheckPath: /health
      autoDeployTrigger: commit
      rootDir: backend

    # Frontend (Next.js)
    - type: web
      name: themoon-frontend
      runtime: node
      repo: https://github.com/usermaum/Themoon
      branch: claude/sync-deeply-from-main-01PSZYknDEZU9i7fVmE9TX4S
      plan: free
      envVars:
      - key: NEXT_PUBLIC_API_URL
        value: https://themoon-api.onrender.com
      - key: NODE_ENV
        value: production
      region: oregon
      buildCommand: npm install && npm run build
      startCommand: npm start
      healthCheckPath: /
      autoDeployTrigger: commit
      rootDir: frontend

    databases:
    - name: themoon-db
      databaseName: themoon
      user: themoon
      plan: free
      region: oregon
      ipAllowList:
      - source: 0.0.0.0/0
        description: everywhere
      postgresMajorVersion: "18"
